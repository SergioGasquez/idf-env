<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

  <!-- development version, includes helpful console warnings -->
  <script src="https://unpkg.com/vue@3"></script>
  <script src="https://unpkg.com/vuex@4"></script>
  <script src="https://unpkg.com/vue-router@4"></script>
  <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
  <!--    <script src="idf_versions.js">-->
  <script type="text/javascript">
    var DOCUMENTATION_VERSIONS = {
      DEFAULTS: {
        has_targets: false,
        supported_targets: ["esp32"]
      },
      VERSIONS: [
        {name: "latest", has_targets: true, supported_targets: ["esp32", "esp32s2"]},

        {
          name: "v4.3-beta1",
          pre_release: true,
          old: false,
          has_targets: true,
          supported_targets: ["esp32", "esp32s2", "esp32c3"]
        },

        {name: "v4.2", old: false, has_targets: true, supported_targets: ["esp32", "esp32s2"]},

        {name: "v4.1.1", old: false},
        {name: "v4.1", old: true},

        {name: "v4.0.2", old: false},
        {name: "v4.0.1", old: true},
        {name: "v4.0", old: true},

        {name: "v3.3.4", old: false},
        {name: "v3.3.3", old: true},
        {name: "v3.3.2", old: true},
        {name: "v3.3.1", old: true},
        {name: "v3.3", old: true},

        {name: "v3.2.5", old: true},

        {name: "v3.1.7", old: true},

        {
          name: "release-v4.3",
          pre_release: true,
          has_targets: true,
          supported_targets: ["esp32", "esp32s2", "esp32c3"]
        },
        {name: "release-v4.2", pre_release: true, has_targets: true, supported_targets: ["esp32", "esp32s2"]},
        {name: "release-v4.1", pre_release: true},
        {name: "release-v4.0", pre_release: true},
        {name: "release-v3.3", pre_release: true}
      ],
      IDF_TARGETS: [
        {text: "ESP32", value: "esp32"},
        {text: "ESP32-S2", value: "esp32s2"},
        {text: "ESP32-C3", value: "esp32c3"}
      ],
      RELEASES: {
        "v3.1": {
          "start_date": "2018-09-07",
          "end_date": "2020-10-31"
        },
        "v3.2": {
          "start_date": "2019-04-11",
          "end_date": "2020-10-31"
        },
        "v3.3": {
          "start_date": "2019-09-05",
          "end_date": "2022-02-28"
        },
        "v4.0": {
          "start_date": "2020-02-11",
          "end_date": "2021-10-31"
        },
        "v4.1": {
          "start_date": "2020-08-24",
          "end_service": "2021-08-24",
          "end_date": "2023-02-24"
        },
        "v4.2": {
          "start_date": "2020-12-07",
          "end_service": "2021-12-07",
          "end_date": "2023-06-07"
        }
      }
    };

    var workloads = [
      {
        id: 'c',
        title: 'C/C++ with ESP-IDF',
        decription: 'Development tools for C/C++ language based on Espressif Integrated Development Framework (ESP-IDF)',
        components: [
          {
            id: 'esp-idf-4.4',
            title: 'ESP-IDF release/4.4'
          },
          // {
          //   id: 'windows-defender-exclusions',
          //   title: 'Register Windows Defender exclusions',
          //   isAdminRequired: true
          // }
        ]
      },
      {
        id: 'rust',
        title: 'Rust language',
        description: 'Development of Rust applications for RISC-V and Xtensa Espressif chips',
        components: [
          // {
          //   id: 'rustup',
          //   title: 'Rustup',
          //   state: 'unknown',
          //   desiredState: 'unknown',
          // },
          {
            id: 'rust-toolchain-stable',
            title: 'Rust Toolchain - stable',
            state: 'unknown',
            desiredState: 'installed',
          },
          {
            id: 'rust-toolchain-nightly',
            title: 'Rust Toolchain - nightly',
            state: 'unknown',
            desiredState: 'installed',
          },
          {
            id: 'rust-toolchain-xtensa',
            title: 'Rust Toolchain for Xtensa',
            state: 'unknown',
            desiredState: 'installed',
          },
          {
            id: 'llvm-xtensa',
            title: 'LLVM for Xtensa',
            state: 'unknown',
            desiredState: 'unknown',
          }
        ]
      },
      // {
      //   id: 'toit',
      //   title: 'Toit language',
      //   description: 'Toit language for IoT devices',
      //   components: [
      //     {
      //       id: 'jaguar',
      //       title: 'Jaguar hot-reload',
      //       state: 'unknown'
      //     }
      //   ]
      // }
    ];

  </script>

  <link rel="stylesheet" type="text/css" href="css/style.css">
</head>

<body>
<div id="app">
  <h1>ESP-IDF Installer</h1>

  <router-view></router-view>
</div>


</body>

<!-- Vue part -->
<script src="js/router/router.js"></script>
<script src="js/store/store.js"></script>

<!-- Control plane -->
<script src="js/rmi/rust-rmi.js"></script>
<script src="js/control-plane/component.js"></script>
<script src="js/control-plane/controller.js"></script>
<script src="js/control-plane/controller-manager.js"></script>

<script type="text/javascript">


  function getDesiredState() {
    return {components: workloads[1].components};
  }


  var componentsController;

  const app = Vue.createApp({});

  function onChangeHandler(event) {
    console.log("State definition changed");
    componentsController.desiredState = getDesiredState();
  }

  function processOnLoad() {
    let controllerManager = new ControllerManager();

    componentsController = new Controller();
    // let rustupComponent = new Component('rustup');
    // componentsController.addComponent(rustupComponent);

    let rustupNightlyComponent = new Component('rust-toolchain-nightly');
    componentsController.addComponent(rustupNightlyComponent);

    let rustupStableComponent = new Component('rust-toolchain-stable');
    componentsController.addComponent(rustupStableComponent);

    componentsController.addComponent(new Component('rust-toolchain-xtensa'));
    componentsController.addComponent(new Component('llvm-xtensa'));

    controllerManager.addController(componentsController);
    controllerManager.loop();

  }

  function UpdateComponent(componentId, observedState) {
    // componentsController.updateComponent(state);
    store.commit('component', {componentId, observedState});
  }

  window.addEventListener("load", processOnLoad);

</script>

<script src="js/components/entry-component.js"></script>
<script src="js/components/modify-component.js"></script>
<script src="js/components/install-component.js"></script>

<script type="text/javascript">
  router.addRoute({path: '/', name:'home', component: app.component('entry-component') });
  router.addRoute({path: '/modify', name:'modify', component: app.component('modify-component') });
  router.addRoute({path: '/install', name:'install', component: app.component('install-component') });
  app.use(router);
  app.use(store);
  router.isReady().then(() => {
    app.mount('#app');
  });

</script>

</html>
